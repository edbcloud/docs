---
title: "Redacting Passwords from Audit Logs"
---

<div id="redacting_passwords_from_audit_logs" class="registered_link"></div>

You can use the `edb_filter_log.redact_password_commands` extension to instruct the server to redact stored passwords from the log file. The syntax is:

```text
{CREATE|ALTER} {USER|ROLE|GROUP} identifier { [WITH] [ENCRYPTED] PASSWORD
'nonempty_string_literal' | IDENTIFIED BY { 'nonempty_string_literal' |
bareword } } [ REPLACE { 'nonempty_string_literal' | bareword } ]
```

When the following statement is logged by `log_statement`, the server will redact the password to `x`. For example, the command:

```text
CREATE USER carol with login PASSWORD '1safepwd';
```

Will be added to log files as:

```text
2021-05-17 05:01:46.841 IST,"enterprisedb","edb",18415,"[local]",60a230f0.47ef,1,"idle",2021-05-17 05:01:36 IST,3/3,0,AUDIT,00000,"statement: CREATE USER carol with login PASSWORD 'x';",,,,,,,,,"psql","client backend","CREATE ROLE","","create"
```

When the following statement is logged by `log_statement`, the server will identify the new password, replace, and redact the password to `x`. For example, the command:
 
```text
ALTER USER carol IDENTIFIED BY 'new_pass' REPLACE '1safepwd'; 
```

Will be added to log files as:

```text
2021-05-19 04:41:45.718 IST,"enterprisedb","edb",19354,"[local]",60a23a72.4b9a,1,"idle",2021-05-19 04:41:23 IST,3/3,0,AUDIT,00000,"statement: ALTER USER carol IDENTIFIED BY 'x' REPLACE 'x';",,,,,,,,,"psql","client backend","ALTER ROLE","","alter"
```

The statement that includes a redacted password is logged, the server redacts the statement text. When the statement is logged as context for some other message, the server omits the statement from the context.

To enable password redaction, you must first enable the extension by modifying the `postgresql.conf` file, adding the following value to the values specified in the `shared_preload_libraries` parameter:

```text
$libdir/edb_filter_log
```

Then, set `edb_filter_log.redact_password_commands` to `true`:

```text
edb_filter_log.redact_password_commands = true
```

After modifying the `postgresql.conf` file, you must restart the server for the changes to take effect.
